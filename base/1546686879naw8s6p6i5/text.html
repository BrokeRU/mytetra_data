<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:120%; background-color:transparent;"><span style=" font-family:'Helvetica Neue,Arial,sans-serif'; font-size:xx-large; font-weight:600; color:#000000; background-color:transparent;">Препроцессинг кода в Python</span></p>
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:transparent;"><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000; background-color:transparent;">Препроцессинг — предварительная обработка исходного файла перед передачей его компилятору. Чаще всего препроцессор вводит расширенный синтаксис, чтобы упростить или оптимизировать какие-то задачи, а на выходе генерирует код, понятный компилятору.</span></p>
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:transparent;"><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000; background-color:transparent;">Если вы имели дело с фронтенд-разработкой, должно быть слышали о coffee, babel, sass, less, postcss — всем этом многообразии. Еще препроцессор в явном виде есть в C — он обеспечивает работу таких штук, как</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:20px; color:#000000; background-color:#f9f9f9;">include</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:20px; color:#000000; background-color:#f9f9f9;">define</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:20px; color:#000000; background-color:#f9f9f9;">ifdef</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:transparent;"><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000; background-color:transparent;">Надеюсь, у нас такие инструменты до масштабов современного фронтенда не дойдут. Однако, идея достойна внимания. Можно бесконечно расширять язык, вводить шорткаты и DSL на уровне приложения, причем совершенно прозрачно. Забавы ради я попробовал добавить в python простой аналог сишной директивы</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:20px; color:#000000; background-color:#f9f9f9;">define</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;">.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; font-style:italic; color:#a0a1a7; background-color:transparent;"># coding: сpreprocessor</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; font-style:italic; color:#a0a1a7; background-color:transparent;"># define True False</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; font-style:italic; color:#a0a1a7; background-color:rgba(0,0,0,0.015686);"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#a626a4; background-color:transparent;">def</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:transparent;"> </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#4078f2; background-color:transparent;">main</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:transparent;">():</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">    </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#a626a4; background-color:transparent;">if</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;"> (</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#986801; background-color:transparent;">1</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;"> &gt; </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#986801; background-color:transparent;">0</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">) </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#a626a4; background-color:transparent;">is</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;"> </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#a626a4; background-color:transparent;">True</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">        print(</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#50a14f; background-color:transparent;">&quot;true branch&quot;</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">    </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#a626a4; background-color:transparent;">else</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">        print(</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#50a14f; background-color:transparent;">&quot;else branch&quot;</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:22px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:rgba(0,0,0,0.015686);"><br /></pre>
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:transparent;"><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000; background-color:transparent;">Вся магия в первой строке. Она указывает интерпретатору на кодировку текущего файла. Чтобы это заработало, зарегистрируем новую кодировку с собственной функцией-декодером. Кроме, собственно, декодинга она заменит все упоминания</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:20px; color:#000000; background-color:#f9f9f9;">True</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> на </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:20px; color:#000000; background-color:#f9f9f9;">False</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> в исходном файле.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:16px; color:#333333; background-color:transparent;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0" bgcolor="#000000">
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:4; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:4; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="gist45162477"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">f</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">rom</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> encodings </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">import</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> utf_8</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L2"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">i</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">mport</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> encodings</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L3"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">i</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">mport</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> codecs</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L4"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">i</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">mport</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> io</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L5"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">d</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">ef</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#6f42c1; background-color:transparent;">cpreprocessor_decode</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">(</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">input</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">, </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">errors</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#032f62; background-color:transparent;">'strict'</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">):</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L8"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">   stream </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> io.StringIO(</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#005cc5; background-color:transparent;">bytes</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">(</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#005cc5; background-color:transparent;">input</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">).decode(</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#032f62; background-color:transparent;">'utf-8'</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">))</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L9"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">   output </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#032f62; background-color:transparent;">''</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">.join(stream.readlines())</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L10"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">   output </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> preprocess(output)</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L11"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">   </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">return</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> output, </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#005cc5; background-color:transparent;">len</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">(</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#005cc5; background-color:transparent;">input</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">)</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L12"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">d</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">ef</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#6f42c1; background-color:transparent;">preprocess</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">(</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">code</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">):</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L15"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">   </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">for</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> line </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">in</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> code.split(</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#032f62; background-color:transparent;">'\n'</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">):</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L16"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">       line </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> line.strip()</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L17"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">       </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">if</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> line.startswith(</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#032f62; background-color:transparent;">'# define'</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">):</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L18"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">           key, val </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> line[</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#005cc5; background-color:transparent;">9</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">:].split()</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L19"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">           code </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> code.replace(key, val)</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L20"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">   </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">return</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> code</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L21"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">d</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">ef</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#6f42c1; background-color:transparent;">search_function</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">(</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">encoding</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">):</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L24"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">   </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">if</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> encoding </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">==</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#032f62; background-color:transparent;">'cpreprocessor'</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">:</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L25"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">       utf8 </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> encodings.search_function(</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#032f62; background-color:transparent;">'utf8'</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">)</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L26"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">       </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">return</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;"> codecs.CodecInfo(</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L27"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">           </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#e36209; background-color:transparent;">name</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#032f62; background-color:transparent;">'cpreprocessor'</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">,</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L28"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">           </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#e36209; background-color:transparent;">encode</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">utf8.encode,</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L29"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">           </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#e36209; background-color:transparent;">decode</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">cpreprocessor_decode,</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L30"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">           </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#e36209; background-color:transparent;">incrementalencoder</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">utf8.incrementalencoder,</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L31"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">           </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#e36209; background-color:transparent;">incrementaldecoder</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">utf_8.IncrementalDecoder,</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L32"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">           </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#e36209; background-color:transparent;">streamreader</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">utf_8.StreamReader,</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L33"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;"> </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">           </span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#e36209; background-color:transparent;">streamwriter</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#d73a49; background-color:transparent;">=</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e;">utf8.streamwriter)</span></pre></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td></tr>
<tr>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;"></td>
<td bgcolor="transparent" style=" vertical-align:top; padding-left:10; padding-right:10; padding-top:1; padding-bottom:1;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:20px;"><a name="file-cpreprocessor-py-L34"></a><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">c</span><span style=" font-family:'SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:12px; color:#24292e; background-color:transparent;">odecs.register(search_function)</span></pre></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a href="https://gist.github.com/zenwalker/3776b8a933ab389cc8d68bffac08073a/raw/0403d579add15b1a6a13087cfb27211cbf0c0d40/cpreprocessor.py"><span style=" font-family:'initial'; font-size:12px; font-weight:600; text-decoration: underline; color:#000000; background-color:#000000;">view raw</span></a><a href="https://gist.github.com/zenwalker/3776b8a933ab389cc8d68bffac08073a#file-cpreprocessor-py"><span style=" font-family:'initial'; font-size:12px; font-weight:600; text-decoration: underline; color:#000000; background-color:#000000;">cpreprocessor.py</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol'; font-size:12px; color:#586069;"> hosted with ❤ by </span><a href="https://github.com/"><span style=" font-family:'initial'; font-size:12px; font-weight:600; text-decoration: underline; color:#000000; background-color:#000000;">GitHub</span></a></p>
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:transparent;"><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000; background-color:transparent;">В точке входа в приложение, первым делом нужно импортнуть</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:20px; color:#000000; background-color:#f9f9f9;">cpreprocessor</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> — он зарегистрирует кодек-препроцессор. Теперь при импорте, файлы, которые начинаются с </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:20px; color:#000000; background-color:#f9f9f9;">coding: cpreprocessor</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> будут обрабатываться нашей функцией.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#a626a4; background-color:transparent;">import</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;"> cpreprocessor  </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; font-style:italic; color:#a0a1a7; background-color:transparent;"># noqa</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#a626a4; background-color:transparent;">from</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;"> app </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#a626a4; background-color:transparent;">import</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;"> main</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:rgba(0,0,0,0.015686);"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#a626a4; background-color:transparent;">if</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;"> __name__ == </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#50a14f; background-color:transparent;">'__main__'</span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:rgba(0,0,0,0.015686);"><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; color:#383a42; background-color:#fafafa;">    main()  </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; font-style:italic; color:#a0a1a7; background-color:transparent;"># will print &quot;false branch&quot;</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:22px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:19px; font-style:italic; color:#a0a1a7; background-color:rgba(0,0,0,0.015686);"><br /></pre>
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:transparent;"><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000; background-color:transparent;">Воспринимайте это как proof of concept. Можно пойти дальше и заменить отступы на фигурные скобки или заменить</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:20px; color:#000000; background-color:#f9f9f9;">self</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> на </span><span style=" font-family:'Ubuntu Mono,Consolas,Liberation Mono,Menlo,Courier,monospace'; font-size:20px; color:#000000; background-color:#f9f9f9;">@</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> прямо как в этом вашем ruby. Но тут уже не обойтись регулярками, придется сделать AST-парсер и может еще поддержку синтаксиса в IDE, чтобы та не сходила с ума.</span></p>
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:transparent;"><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000; background-color:transparent;">На одном из последних Moscow.Python был</span><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> </span><a href="https://www.youtube.com/watch?v=90JI8rpBh8Y"><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#0066cc; background-color:transparent;">доклад</span></a><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> про </span><a href="https://github.com/pythonql/pythonql"><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#0066cc; background-color:transparent;">PythonQL</span></a><span style=" font-family:'Charter,Georgia,Times,serif'; font-size:20px; color:#000000;"> — DSL для запросов к SQL, NoSQL который именно так и работает. Там реально свой язык внутри generator expressions.</span></p>
<p style=" margin-top:20px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:130%; background-color:transparent;"><span style=" font-family:'Helvetica Neue,Arial,sans-serif'; font-size:large; font-weight:600; color:#888888; background-color:transparent;">Ссылки по теме</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'system-ui,Trebuchet MS,Helvetica Neue,Arial,sans-serif'; font-size:20px; color:#000000; background-color:transparent;" style=" margin-top:0px; margin-bottom:7px; margin-left:48px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.python.org/dev/peps/pep-0263/"><span style=" font-size:20px; color:#0066cc;">PEP 263 — Defining Python Source Code Encodings</span></a></li>
<li style=" font-family:'system-ui,Trebuchet MS,Helvetica Neue,Arial,sans-serif'; font-size:20px; color:#000000; background-color:transparent;" style=" margin-top:0px; margin-bottom:24px; margin-left:48px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://github.com/evanplaice/pypreprocessor"><span style=" font-size:20px; color:#0066cc;">A C-style macro preprocessor written in Python</span></a></li></ul></body></html>