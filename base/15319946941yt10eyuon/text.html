<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В PostgreSQL возможно создание временных таблиц, которые могут быть автоматически удалены, например, по завершению транзакции. Временные таблицы полностью поддерживают все возможности обычных таблиц.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">CREATE { TEMPORARY | TEMP } TABLE [ IF NOT EXISTS ] </span><span style=" font-family:'Sans Serif'; font-style:italic;">имя_таблицы</span><span style=" font-family:'Sans Serif';"> ( [</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">  { </span><span style=" font-family:'Sans Serif'; font-style:italic;">имя_столбца</span><span style=" font-family:'Sans Serif';"> </span><span style=" font-family:'Sans Serif'; font-style:italic;">тип_данных</span><span style=" font-family:'Sans Serif';"> [ COLLATE </span><span style=" font-family:'Sans Serif'; font-style:italic;">правило_сортировки</span><span style=" font-family:'Sans Serif';"> ] [ </span><span style=" font-family:'Sans Serif'; font-style:italic;">ограничение_столбца</span><span style=" font-family:'Sans Serif';"> [ ... ] ]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">    | </span><span style=" font-family:'Sans Serif'; font-style:italic;">ограничение_таблицы</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">    | LIKE </span><span style=" font-family:'Sans Serif'; font-style:italic;">исходная_таблица</span><span style=" font-family:'Sans Serif';"> [ </span><span style=" font-family:'Sans Serif'; font-style:italic;">вариант_копирования</span><span style=" font-family:'Sans Serif';"> ... ] }</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">    [, ... ]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">] )</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">[ INHERITS ( </span><span style=" font-family:'Sans Serif'; font-style:italic;">таблица_родитель</span><span style=" font-family:'Sans Serif';"> [, ... ] ) ]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">[ WITH ( </span><span style=" font-family:'Sans Serif'; font-style:italic;">параметр_хранения</span><span style=" font-family:'Sans Serif';"> [= </span><span style=" font-family:'Sans Serif'; font-style:italic;">значение</span><span style=" font-family:'Sans Serif';">] [, ... ] ) | WITH OIDS | WITHOUT OIDS ]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">[ ON COMMIT { PRESERVE ROWS | DELETE ROWS | DROP } ]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">[ TABLESPACE </span><span style=" font-family:'Sans Serif'; font-style:italic;">табл_пространство</span><span style=" font-family:'Sans Serif';"> ]</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans Serif';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif';">Пример:</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans Serif';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans Mono'; color:#6a8759;">CREATE TEMP TABLE full_features_history ON COMMIT DROP<br />AS<br />    SELECT<br />        *<br />    FROM<br />    (<br />        SELECT<br />            id, geog, layer, username, action_type, parent_id, sys_period<br />        FROM<br />            features<br />        WHERE<br />            layer != 'pano'<br /><br />        UNION ALL<br /><br />        SELECT<br />            id, geog, layer, username, action_type, parent_id, sys_period<br />        FROM<br />            features_history<br />        WHERE<br />            layer != 'pano'<br />    ) AS combined<br />    ORDER BY sys_period DESC;<br /><br />-- Создаем необходимые индексы на временной таблице<br />CREATE INDEX ON full_features_history(id);<br />CREATE INDEX ON full_features_history(id, username);<br /></span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans Mono'; color:#6a8759;">-- Анализируем содержимое временной таблицы<br />ANALYZE full_features_history;</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans Mono'; color:#6a8759;"><br /></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans Mono'; color:#6a8759;"><br /></pre></body></html>